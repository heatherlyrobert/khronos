#!/usr/local/bin/koios
#   koios-polos (axis of heaven) unit testing meta-language



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  -  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  t  ========(var)======= 
PREP          include the prototype headers                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   - - - - -   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
   incl       include crond header                 khronos.h                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   - - - - -   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  -  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  t  ========(var)======= 
SCRP          (BASE) verify central directory checking                           base_check_dir                                                                                        ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       prepare for run                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     initialize the system                prog__unit_quiet                                                                                                                  i_equal     0                                                                                                    

   COND       start with a unit test dir                                         - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call directory validatation          base_check_dir                                                                                                                    i_equal     0                                                                                                    
     get      ...check directory                   base__unit                  "central"              , 0                                                                            s_equal     BASE central     : 18[/tmp/khronos_test/]                    y                                       

   COND       attempt an empty directory                                         - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.003))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     update the directory                 - - - - - - - - - - - - -   strlcpy (my.n_central  , ""                                  , LEN_PATH);                                                                                                                                                  
     exec     call directory validatation          base_check_dir                                                                                                                    i_lesser    0                                                                                                    
     get      ...check directory                   base__unit                  "central"              , 0                                                                            s_equal     BASE central     :  0[]                                      e                                       

   COND       attempt to use root                                                - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.004))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     update the directory                 - - - - - - - - - - - - -   strlcpy (my.n_central  , "/"                                 , LEN_PATH);                                                                                                                                                  
     exec     call directory validatation          base_check_dir                                                                                                                    i_lesser    0                                                                                                    
     get      ...check directory                   base__unit                  "central"              , 0                                                                            s_equal     BASE central     :  1[/]                                     e                                       

   COND       attempt to use an existing root subdirectory                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.005))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     update the directory                 - - - - - - - - - - - - -   strlcpy (my.n_central  , "/etc/"                             , LEN_PATH);                                                                                                                                                  
     exec     call directory validatation          base_check_dir                                                                                                                    i_lesser    0                                                                                                    
     get      ...check directory                   base__unit                  "central"              , 0                                                                            s_equal     BASE central     :  5[/etc/]                                 e                                       

   COND       attempt non-existant directory                                     - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.006))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     update the directory                 - - - - - - - - - - - - -   strlcpy (my.n_central  , "/tmp/arstioen/"                    , LEN_PATH);                                                                                                                                                  
     exec     call directory validatation          base_check_dir                                                                                                                    i_lesser    0                                                                                                    
     get      ...check directory                   base__unit                  "central"              , 0                                                                            s_equal     BASE central     : 14[/tmp/arstioen/]                        e                                       

   COND       attempt to point at an existing file                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.007))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     update the directory                 - - - - - - - - - - - - -   strlcpy (my.n_central  , "/var/lib/helios/helios.db"         , LEN_PATH);                                                                                                                                                  
     exec     call directory validatation          base_check_dir                                                                                                                    i_lesser    0                                                                                                    
     get      ...check directory                   base__unit                  "central"              , 0                                                                            s_equal     BASE central     : 25[/var/lib/helios/helios.db]             e                                       

   COND       use the standard directory                                         - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     update the directory                 - - - - - - - - - - - - -   strlcpy (my.n_central  , DIR_CENTRAL                         , LEN_PATH);                                                                                                                                                  
     exec     call directory validatation          base_check_dir                                                                                                                    i_equal     0                                                                                                    
     get      ...check directory                   base__unit                  "central"              , 0                                                                            s_equal     BASE central     : 20[/var/spool/crontabs/]                  -                                       

   COND       switch back to unit test dir                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.009))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     update the directory                 - - - - - - - - - - - - -   strlcpy (my.n_central  , DIR_UNIT                            , LEN_PATH);                                                                                                                                                  
     exec     call directory validatation          base_check_dir                                                                                                                    i_equal     0                                                                                                    
     get      ...check directory                   base__unit                  "central"              , 0                                                                            s_equal     BASE central     : 18[/tmp/khronos_test/]                    y                                       

   COND       attempt with lesser owner account                                  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     update diretory ownership            - - - - - - - - - - - - -   system ("chown member:root   /tmp/khronos_test/");                                                                                                                                                                         
     exec     call directory validatation          base_check_dir                                                                                                                    i_lesser    0                                                                                                    
     get      ...check directory                   base__unit                  "central"              , 0                                                                            s_equal     BASE central     : 18[/tmp/khronos_test/]                    e                                       

   COND       switch back to correct owner account                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.011))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     update diretory ownership            - - - - - - - - - - - - -   system ("chown root:root     /tmp/khronos_test/");                                                                                                                                                                         
     exec     call directory validatation          base_check_dir                                                                                                                    i_equal     0                                                                                                    
     get      ...check directory                   base__unit                  "central"              , 0                                                                            s_equal     BASE central     : 18[/tmp/khronos_test/]                    y                                       

   COND       attempt with lesser group account                                  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.012))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     update diretory ownership            - - - - - - - - - - - - -   system ("chown root:users    /tmp/khronos_test/");                                                                                                                                                                         
     exec     call directory validatation          base_check_dir                                                                                                                    i_lesser    0                                                                                                    
     get      ...check directory                   base__unit                  "central"              , 0                                                                            s_equal     BASE central     : 18[/tmp/khronos_test/]                    e                                       

   COND       switch back to correct group account                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.013))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     update diretory ownership            - - - - - - - - - - - - -   system ("chown root:root     /tmp/khronos_test/");                                                                                                                                                                         
     exec     call directory validatation          base_check_dir                                                                                                                    i_equal     0                                                                                                    
     get      ...check directory                   base__unit                  "central"              , 0                                                                            s_equal     BASE central     : 18[/tmp/khronos_test/]                    y                                       

   COND       attempt with different permissions                                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.014))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     update diretory ownership            - - - - - - - - - - - - -   system ("chmod 0777          /tmp/khronos_test/");                                                                                                                                                                         
     exec     call directory validatation          base_check_dir                                                                                                                    i_lesser    0                                                                                                    
     get      ...check directory                   base__unit                  "central"              , 0                                                                            s_equal     BASE central     : 18[/tmp/khronos_test/]                    e                                       

   COND       attempt with different permissions                                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.015))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     update diretory ownership            - - - - - - - - - - - - -   system ("chmod 0246          /tmp/khronos_test/");                                                                                                                                                                         
     exec     call directory validatation          base_check_dir                                                                                                                    i_lesser    0                                                                                                    
     get      ...check directory                   base__unit                  "central"              , 0                                                                            s_equal     BASE central     : 18[/tmp/khronos_test/]                    e                                       

   COND       switch back to correct group account                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.016))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     update diretory ownership            - - - - - - - - - - - - -   system ("chmod 0700          /tmp/khronos_test/");                                                                                                                                                                         
     exec     call directory validatation          base_check_dir                                                                                                                    i_equal     0                                                                                                    
     get      ...check directory                   base__unit                  "central"              , 0                                                                            s_equal     BASE central     : 18[/tmp/khronos_test/]                    y                                       

   COND       wrap up testing                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.017))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     wrap up                              prog__unit_end                                                                                                                    i_equal     0                                                                                                    



# end-of-file.  done, finito, completare, whimper [Ï´···
